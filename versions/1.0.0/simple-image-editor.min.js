/*! simple-image-editor 1.0.0 by: Sam North. Built on 08-31-2018 */
function simpleImageEditor(e){var o,d,t,i,s,a,c,l=e||{},r={pencil:0,line:1},u=l.defaultDrawingThickness||6,n=!1,m=void 0===l.showDownloadButton||l.showDownloadButton,v=void 0!==l.showSaveButton&&l.showSaveButton,g=0;function h(e){var t;document.getElementById("sie-hp").setAttribute("src",e),(t=document.getElementById("sie-c")).classList.remove("sie-h"),t.classList.add("sie-ib"),g=0,d.clearRect(0,0,o.width,o.height),function(){document.getElementById("sie-rb").addEventListener("click",y,!1);var e=document.getElementById("sie-lw");e.value=u,e.addEventListener("change",P,!1),R();var t=document.getElementById("sie-cp");t.addEventListener("change",X,!1),t.value=l.defaultDrawingColor||"#FF0000",X(),o.addEventListener("mousedown",L,!1),o.addEventListener("mousemove",x,!1),o.addEventListener("mouseup",k,!1),o.addEventListener("mouseout",k,!1);var i=document.getElementById("sie-sb");v?i.addEventListener("click",Y,!1):i.classList.add("sie-h");var n=document.getElementById("sie-d");m?n.addEventListener("click",C,!1):n.classList.add("sie-h");var s=document.getElementsByClassName("sie-dc");for(var d in s)if(s.hasOwnProperty(d)){var a=s[d];a.addEventListener("click",D,!1)}l.defaultDrawingControl&&""!==l.defaultDrawingControl?N(l.defaultDrawingControl):document.getElementById("sie-c").getElementsByClassName("sie-dc")[0].click()}()}function p(e){h(e.target.result)}function f(){var e=document.getElementById("sie-hp"),t=e.width/o.width,i=e.height/t,n=o.height-i,s=0<n&&(90===g||180===g)?n:0;d.drawImage(e,0,s,o.width,i)}function b(e){if(e&&""!==e){var t=e.lastIndexOf("\\");-1===t&&(t=e.lastIndexOf("/"));var i=(a=-1===t?e:e.substring(t+1)).lastIndexOf(".");-1!=i&&(s=a.substring(0,i))}else s=a="simple-image-editor"}function w(){i={pX:0,pY:0,X:0,Y:0,beginX:0,beginY:0,endX:0,endY:0}}function y(e){d.save();var t=(g=(g+90)%360)*Math.PI/180;d.clearRect(0,0,o.width,o.height);var i=90===g||180===g?o.width:0,n=180===g||270===g?o.height:0;d.translate(i,n),d.rotate(t),f(),d.rotate(-t),d.translate(-i,n),d.restore()}function E(e){return e.clientX-o.getBoundingClientRect().left}function I(e){return e.clientY-o.getBoundingClientRect().top}function B(e){i.pX=i.X,i.pY=i.Y,i.X=E(e),i.Y=I(e)}function L(e){w(),i.beginX=E(e),i.beginY=I(e),B(e),n=!0}function x(e){n&&(B(e),c===r.pencil&&(d.beginPath(),d.moveTo(i.pX,i.pY),d.lineTo(i.X,i.Y),d.strokeStyle=t,d.lineWidth=u,d.stroke(),d.closePath()))}function k(e){i.endX=E(e),i.endY=I(e),n&&c===r.line&&(d.beginPath(),d.moveTo(i.beginX,i.beginY),d.lineTo(i.endX,i.endY),d.strokeStyle=t,d.lineWidth=u,d.stroke(),d.closePath()),n=!1,w()}function X(){var e=document.getElementById("sie-cp");t=e.value}function Y(){var e=document.getElementById("sie-hsl"),t=l.exportImageFileType||"png",i=decodeURI(s+"."+t),n=o.toDataURL("image/"+t).replace("image/"+t,"image/octet-stream");return e.setAttribute("download",i),e.setAttribute("href",n),{originalFileName:decodeURI(a),base64Image:n,editedFileName:i}}function C(){Y(),document.getElementById("sie-hsl").click()}function D(e){N(e.target.dataset.value)}function N(e){var t=e;isNaN(t)&&(t=r[e]),c=Number(t);var i=document.getElementsByClassName("sie-dc");for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];s.classList.remove("sie-pc"),s.removeAttribute("disabled"),Number(s.dataset.value)===c&&(s.setAttribute("disabled","disabled"),s.classList.add("sie-pc"))}}function R(){document.getElementById("sie-lwd").textContent=u}function P(e){u=Number(e.target.value),R()}return document.getElementById(l.containerId).innerHTML='<style>.sie-cnt{position:relative;overflow:hidden;margin-bottom:10px;margin-top:10px;text-align:center;border:1px #000 solid}.sie-cnt>img{width:96%;position:absolute;display:block;top:0;left:6px}#sie-cnv:hover{cursor:cell}.sie-ib{display:inline-block}.sie-h{display:none!important}#sie-cnt{display:hidden}#sie-c{vertical-align:top;margin-left:10px;min-width:155px;width:155px}#sie-c .sie-cc{margin-top:10px;margin-bottom:10px}.sie-pc{color:#fff;background-color:#494a4f;border:#767676 2px solid}#sie-lw{width:50px}</style><input id="sie-fu" type="file"><br><div id="sie"><canvas id="sie-cnv" class="sie-cnt"></canvas><div id="sie-cnt" class="sie-cnt sie-h"><img id="sie-hp"> <a id="sie-hsl"></a></div><div id="sie-c" class="sie-h"><div class="sie-cc"><button id="sie-rb">Rotate</button></div><hr><div class="sie-cc"><input id="sie-cp" type="color"> <span>Select color</span></div><div class="sie-cc"><input id="sie-lw" min="1" max="10" type="range"> <span>Line width: <span id="sie-lwd"></span></span></div><div class="sie-cc"><button data-value="0" class="sie-dc">Pencil</button></div><div class="sie-cc"><button data-value="1" class="sie-dc">Line</button></div><hr><div class="sie-cc"><button id="sie-sb">Save</button> <button id="sie-d">Download</button></div></div></div>',w(),document.getElementById("sie-fu").addEventListener("input",function(e){var t=e.target.files[0],i=new FileReader;i.onload=p,i.readAsDataURL(t),b(t.name)},!1),document.getElementById("sie-hp").addEventListener("load",f,!1),(o=document.getElementById("sie-cnv")).width=l.width||300,o.height=l.height||o.width,d=o.getContext("2d"),{saveImage:Y,loadImage:function(e){b(e.src),h(e.src)}}}