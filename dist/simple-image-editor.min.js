/*! simple-image-editor 1.0.0 by: Sam North. Built on 09-19-2018 */
function simpleImageEditor(e){var o,d,a,c,l,r,s,g,u,v,h,m,p,b=e||{},w={pencil:0,line:1,arrow:2,eraser:3},f=b.defaultDrawingThickness||6,i=!1,y=void 0===b.showDownloadButton||b.showDownloadButton,I=void 0!==b.showSaveButton&&b.showSaveButton,E=0;function t(e){var t;document.getElementById("sie-hp").setAttribute("src",e),(t=document.getElementById("sie-c")).classList.remove("sie-h"),t.classList.add("sie-ib"),E=0,r.clearRect(0,0,o.width,o.height),function(){document.getElementById("sie-rb").addEventListener("click",L,!1);var e=document.getElementById("sie-lw");e.value=f,e.addEventListener("change",O,!1),M();var t=document.getElementById("sie-cp");t.addEventListener("change",N,!1),t.value=b.defaultDrawingColor||"#FF0000",N(),o.addEventListener("mousedown",C,!1),o.addEventListener("mousemove",P,!1),o.addEventListener("mouseup",D,!1),o.addEventListener("mouseout",D,!1);var i=document.getElementById("sie-sb");I?i.addEventListener("click",S,!1):i.classList.add("sie-h");var n=document.getElementById("sie-d");y?n.addEventListener("click",T,!1):n.classList.add("sie-h");var s=document.getElementsByClassName("sie-dc");for(var a in s)if(s.hasOwnProperty(a)){var d=s[a];d.addEventListener("click",A,!1)}b.defaultDrawingControl&&""!==b.defaultDrawingControl?F(b.defaultDrawingControl):document.getElementById("sie-c").getElementsByClassName("sie-dc")[0].click()}()}function n(e){t(e.target.result)}function B(){var e=document.getElementById("sie-hp"),t=e.width/o.width,i=e.height/t;o.height;r.drawImage(e,0,0,o.width,i)}function Y(e){if(e&&""!==e){var t=e.lastIndexOf("\\");-1===t&&(t=e.lastIndexOf("/"));var i=(m=-1===t?e:e.substring(t+1)).lastIndexOf(".");-1!=i&&(h=m.substring(0,i))}else h=m="simple-image-editor"}function X(){v={pX:0,pY:0,X:0,Y:0,beginX:0,beginY:0,endX:0,endY:0}}function L(e){r.save();var t=(E=(E+90)%360)*Math.PI/180;r.clearRect(0,0,l.width,l.height);var i=90===E||180===E?o.width:0,n=180===E||270===E?o.height:0;r.translate(i,n),r.rotate(t),B(),r.rotate(-t),r.translate(-i,n),r.restore();var s=90*Math.PI/180;c.translate(a.width,0),c.rotate(s),c.clearRect(0,0,a.width,a.height),c.drawImage(o,0,0),c.rotate(-s),c.translate(-a.width,0),c.restore(),d.clearRect(0,0,o.width,o.height),d.drawImage(a,0,0),c.clearRect(0,0,a.width,a.height)}function x(e){return e.clientX-o.getBoundingClientRect().left}function k(e){return e.clientY-o.getBoundingClientRect().top}function R(e){v.pX=v.X,v.pY=v.Y,v.X=x(e),v.Y=k(e)}function C(e){X(),v.beginX=x(e),v.beginY=k(e),R(e),i=!0}function P(e){var t;i&&(R(e),p===w.pencil?(d.beginPath(),d.moveTo(v.pX,v.pY),d.lineTo(v.X,v.Y),d.strokeStyle=u,d.lineWidth=f,d.stroke(),d.closePath()):p===w.eraser&&(t=f/2,d.clearRect(v.X-t,v.Y-t,f,f)))}function D(e){v.endX=x(e),v.endY=k(e),i&&p===w.line?(d.beginPath(),d.moveTo(v.beginX,v.beginY),d.lineTo(v.endX,v.endY),d.strokeStyle=u,d.lineWidth=f,d.stroke(),d.closePath()):i&&p===w.arrow&&function(){d.beginPath(),d.moveTo(v.beginX,v.beginY),d.lineTo(v.endX,v.endY),d.strokeStyle=u,d.lineWidth=f,d.stroke(),d.closePath(),console.log("Arrow draw: ","beginX: "+v.beginX,"endX: "+v.endX,"beginY: "+v.beginY,"endY: "+v.endY);var e=(v.endY-v.beginY)/(v.endX-v.beginX),t=Math.sqrt(Math.pow(v.endX-v.beginX,2)+Math.pow(v.endY-v.beginY,2)),i=e/2,n=2*e;console.log("slope:"+e),console.log("distanceOfLine:"+t),console.log("halfSlope:"+i),console.log("doubleSlope:"+n);var s=v.endY-v.endX*e;console.log("y=mx+b: with "+v.endY+" - ("+v.endX+" * "+e+") = "+s);var a=(0-s)/e;console.log("YIntercept = ("+a+","+s+")")}(),i=!1,X()}function N(){var e=document.getElementById("sie-cp");u=e.value}function S(){var e=document.getElementById("sie-hsl"),t=b.exportImageFileType||"png",i=decodeURI(h+"."+t);g.clearRect(0,0,s.width,s.height),g.drawImage(l,0,0),g.drawImage(o,0,0);var n=s.toDataURL("image/"+t).replace("image/"+t,"image/octet-stream");return e.setAttribute("download",i),e.setAttribute("href",n),{originalFileName:decodeURI(m),base64Image:n,editedFileName:i}}function T(){S(),document.getElementById("sie-hsl").click()}function A(e){F(e.target.dataset.value)}function F(e){var t=e;isNaN(t)&&(t=w[e]),p=Number(t);var i=document.getElementsByClassName("sie-dc");for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];s.classList.remove("sie-pc"),s.removeAttribute("disabled"),Number(s.dataset.value)===p&&(s.setAttribute("disabled","disabled"),s.classList.add("sie-pc"))}}function M(){document.getElementById("sie-lwd").textContent=f}function O(e){f=Number(e.target.value),M()}return document.getElementById(b.containerId).innerHTML='<style>#sie-cnv{position:relative}#sie-i-cnv{position:absolute}#sie-h-cnv{display:none;position:relative}#sie-f-cnv{display:none;position:relative}.sie-cnt{overflow:hidden;margin-bottom:10px;margin-top:10px;text-align:center;border:1px #000 solid}.sie-cnt>img{width:96%;position:absolute;display:block;top:0;left:6px}#sie-cnv:hover{cursor:cell}.sie-ib{display:inline-block}.sie-h{display:none!important}#sie-cnt{display:hidden}#sie-c{vertical-align:top;margin-left:10px;min-width:155px;width:155px}#sie-c .sie-cc{margin-top:10px;margin-bottom:10px}.sie-pc{color:#fff;background-color:#494a4f;border:#767676 2px solid}#sie-lw{width:50px}</style><input id="sie-fu" type="file"><br><div id="sie"><canvas id="sie-i-cnv" class="sie-cnt"></canvas><canvas id="sie-cnv" class="sie-cnt"></canvas><canvas id="sie-h-cnv" class="sie-cnt"></canvas><canvas id="sie-f-cnv" class="sie-cnt"></canvas><div id="sie-cnt" class="sie-cnt sie-h"><img id="sie-hp"> <a id="sie-hsl"></a></div><div id="sie-c" class="sie-h"><div class="sie-cc"><button id="sie-rb">Rotate</button></div><hr><div class="sie-cc"><input id="sie-cp" type="color"> <span>Select color</span></div><div class="sie-cc"><input id="sie-lw" min="1" max="10" type="range"> <span>Line width: <span id="sie-lwd"></span></span></div><div class="sie-cc"><button data-value="3" class="sie-dc">Eraser</button></div><div class="sie-cc"><button data-value="0" class="sie-dc">Pencil</button></div><div class="sie-cc"><button data-value="1" class="sie-dc">Line</button></div><div class="sie-cc"><button data-value="2" class="sie-dc">Arrow</button></div><hr><div class="sie-cc"><button id="sie-sb">Save</button> <button id="sie-d">Download</button></div></div></div>',X(),document.getElementById("sie-fu").addEventListener("input",function(e){var t=e.target.files[0],i=new FileReader;i.onload=n,i.readAsDataURL(t),Y(t.name)},!1),document.getElementById("sie-hp").addEventListener("load",B,!1),(o=document.getElementById("sie-cnv")).width=b.width||300,o.height=b.height||o.width,d=o.getContext("2d"),(a=document.getElementById("sie-h-cnv")).width=b.width||300,a.height=b.height||a.width,c=a.getContext("2d"),(l=document.getElementById("sie-i-cnv")).width=b.width||300,l.height=b.height||l.width,r=l.getContext("2d"),(s=document.getElementById("sie-f-cnv")).width=b.width||300,s.height=b.height||s.width,g=s.getContext("2d"),{saveImage:S,loadImage:function(e){Y(e.src),t(e.src)}}}