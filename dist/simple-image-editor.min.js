/*! simple-image-editor 1.0.0 by: Sam North. Built on 09-20-2018 */
function simpleImageEditor(e){var o,h,a,d,c,l,s,r,g,m,u,v,p,b=e||{},w={pencil:0,line:1,arrow:2,eraser:3},f=b.defaultDrawingThickness||6,i=!1,y=void 0===b.showDownloadButton||b.showDownloadButton,I=void 0!==b.showSaveButton&&b.showSaveButton,E=0;function t(e){var t;document.getElementById("sie-hp").setAttribute("src",e),(t=document.getElementById("sie-c")).classList.remove("sie-h"),t.classList.add("sie-ib"),E=0,l.clearRect(0,0,o.width,o.height),function(){document.getElementById("sie-rb").addEventListener("click",X,!1);var e=document.getElementById("sie-lw");e.value=f,e.addEventListener("change",U,!1),O();var t=document.getElementById("sie-cp");t.addEventListener("change",N,!1),t.value=b.defaultDrawingColor||"#FF0000",N(),o.addEventListener("mousedown",P,!1),o.addEventListener("mousemove",T,!1),o.addEventListener("mouseup",D,!1),o.addEventListener("mouseout",D,!1);var i=document.getElementById("sie-sb");I?i.addEventListener("click",S,!1):i.classList.add("sie-h");var n=document.getElementById("sie-d");y?n.addEventListener("click",A,!1):n.classList.add("sie-h");var s=document.getElementsByClassName("sie-dc");for(var a in s)if(s.hasOwnProperty(a)){var d=s[a];d.addEventListener("click",F,!1)}b.defaultDrawingControl&&""!==b.defaultDrawingControl?M(b.defaultDrawingControl):document.getElementById("sie-c").getElementsByClassName("sie-dc")[0].click()}()}function n(e){t(e.target.result)}function B(){var e=document.getElementById("sie-hp"),t=e.width/o.width,i=e.height/t;o.height;l.drawImage(e,0,0,o.width,i)}function x(e){if(e&&""!==e){var t=e.lastIndexOf("\\");-1===t&&(t=e.lastIndexOf("/"));var i=(v=-1===t?e:e.substring(t+1)).lastIndexOf(".");-1!=i&&(u=v.substring(0,i))}else u=v="simple-image-editor"}function L(){m={pX:0,pY:0,X:0,Y:0,beginX:0,beginY:0,endX:0,endY:0}}function X(e){l.save();var t=(E=(E+90)%360)*Math.PI/180;l.clearRect(0,0,c.width,c.height);var i=90===E||180===E?o.width:0,n=180===E||270===E?o.height:0;l.translate(i,n),l.rotate(t),B(),l.rotate(-t),l.translate(-i,n),l.restore();var s=90*Math.PI/180;d.translate(a.width,0),d.rotate(s),d.clearRect(0,0,a.width,a.height),d.drawImage(o,0,0),d.rotate(-s),d.translate(-a.width,0),d.restore(),h.clearRect(0,0,o.width,o.height),h.drawImage(a,0,0),d.clearRect(0,0,a.width,a.height)}function Y(e){return e.clientX-o.getBoundingClientRect().left}function k(e){return e.clientY-o.getBoundingClientRect().top}function R(e){m.pX=m.X,m.pY=m.Y,m.X=Y(e),m.Y=k(e)}function C(){var e=m.endX-m.beginX,t=.1*e,i=.07*e,n=m.endX-t,s=m.endX-i,a=m.endY-m.beginY,d=.1*a,o=.07*a,c=m.endY-d,l=m.endY-o,r=m.endY-m.beginY,u=m.endX-m.beginX,v=function(e,t,i,n){var s,a,d,o;if(0===n)s=e+i,d=e-i,o=a=t;else if(isFinite(n)){var c=i/Math.sqrt(1+Math.pow(n,2)),l=n*c;s=e+c,a=t+l,d=e-c,o=t-l}else a=t+i,d=s=e,o=t-i;return{a:{x:s,y:a},b:{x:d,y:o}}}(n,c,2.5*f,u/r*-1);h.beginPath(),h.moveTo(m.beginX,m.beginY),h.lineTo(s,l),h.strokeStyle=g,h.lineWidth=f,h.stroke(),h.closePath(),h.beginPath(),h.moveTo(v.a.x,v.a.y),h.lineTo(v.b.x,v.b.y),h.lineTo(m.endX,m.endY),h.fillStyle=g,h.fill(),h.closePath()}function P(e){L(),m.beginX=Y(e),m.beginY=k(e),R(e),i=!0}function T(e){var t;i&&(R(e),p===w.pencil?(h.beginPath(),h.moveTo(m.pX,m.pY),h.lineTo(m.X,m.Y),h.strokeStyle=g,h.lineWidth=f,h.stroke(),h.closePath()):p===w.eraser&&(t=3*f,h.clearRect(m.X-f,m.Y-f,t,t)))}function D(e){m.endX=Y(e),m.endY=k(e),i&&p===w.line?(h.beginPath(),h.moveTo(m.beginX,m.beginY),h.lineTo(m.endX,m.endY),h.strokeStyle=g,h.lineWidth=f,h.stroke(),h.closePath()):i&&p===w.arrow&&C(),i=!1,L()}function N(){var e=document.getElementById("sie-cp");g=e.value}function S(){var e=document.getElementById("sie-hsl"),t=b.exportImageFileType||"png",i=decodeURI(u+"."+t);r.clearRect(0,0,s.width,s.height),r.drawImage(c,0,0),r.drawImage(o,0,0);var n=s.toDataURL("image/"+t).replace("image/"+t,"image/octet-stream");return e.setAttribute("download",i),e.setAttribute("href",n),{originalFileName:decodeURI(v),base64Image:n,editedFileName:i}}function A(){S(),document.getElementById("sie-hsl").click()}function F(e){M(e.target.dataset.value)}function M(e){var t=e;isNaN(t)&&(t=w[e]),p=Number(t);var i=document.getElementsByClassName("sie-dc");for(var n in i)if(i.hasOwnProperty(n)){var s=i[n];s.classList.remove("sie-pc"),s.removeAttribute("disabled"),Number(s.dataset.value)===p&&(s.setAttribute("disabled","disabled"),s.classList.add("sie-pc"))}}function O(){document.getElementById("sie-lwd").textContent=f}function U(e){f=Number(e.target.value),O()}return document.getElementById(b.containerId).innerHTML='<style>#sie-cnv{position:relative}#sie-i-cnv{position:absolute}#sie-h-cnv{display:none;position:relative}#sie-f-cnv{display:none;position:relative}.sie-cnt{overflow:hidden;margin-bottom:10px;margin-top:10px;text-align:center;border:1px #000 solid}.sie-cnt>img{width:96%;position:absolute;display:block;top:0;left:6px}#sie-cnv:hover{cursor:cell}.sie-ib{display:inline-block}.sie-h{display:none!important}#sie-cnt{display:hidden}#sie-c{vertical-align:top;margin-left:10px;min-width:155px;width:155px}#sie-c .sie-cc{margin-top:10px;margin-bottom:10px}.sie-pc{color:#fff;background-color:#494a4f;border:#767676 2px solid}#sie-lw{width:50px}</style><input id="sie-fu" type="file"><br><div id="sie"><canvas id="sie-i-cnv" class="sie-cnt"></canvas><canvas id="sie-cnv" class="sie-cnt"></canvas><canvas id="sie-h-cnv" class="sie-cnt"></canvas><canvas id="sie-f-cnv" class="sie-cnt"></canvas><div id="sie-cnt" class="sie-cnt sie-h"><img id="sie-hp"> <a id="sie-hsl"></a></div><div id="sie-c" class="sie-h"><div class="sie-cc"><button id="sie-rb">Rotate</button></div><hr><div class="sie-cc"><input id="sie-cp" type="color"> <span>Select color</span></div><div class="sie-cc"><input id="sie-lw" min="1" max="10" type="range"> <span>Line width: <span id="sie-lwd"></span></span></div><div class="sie-cc"><button data-value="3" class="sie-dc">Eraser</button></div><div class="sie-cc"><button data-value="0" class="sie-dc">Pencil</button></div><div class="sie-cc"><button data-value="1" class="sie-dc">Line</button></div><div class="sie-cc"><button data-value="2" class="sie-dc">Arrow</button></div><hr><div class="sie-cc"><button id="sie-sb">Save</button> <button id="sie-d">Download</button></div></div></div>',L(),document.getElementById("sie-fu").addEventListener("input",function(e){var t=e.target.files[0],i=new FileReader;i.onload=n,i.readAsDataURL(t),x(t.name)},!1),document.getElementById("sie-hp").addEventListener("load",B,!1),(o=document.getElementById("sie-cnv")).width=b.width||300,o.height=b.height||o.width,h=o.getContext("2d"),(a=document.getElementById("sie-h-cnv")).width=b.width||300,a.height=b.height||a.width,d=a.getContext("2d"),(c=document.getElementById("sie-i-cnv")).width=b.width||300,c.height=b.height||c.width,l=c.getContext("2d"),(s=document.getElementById("sie-f-cnv")).width=b.width||300,s.height=b.height||s.width,r=s.getContext("2d"),{saveImage:S,loadImage:function(e){x(e.src),t(e.src)}}}